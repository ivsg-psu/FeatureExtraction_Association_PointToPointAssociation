% script_test_fcn_Points_calcPairStatistics.m
% This is a script to exercise the function:
% fcn_Points_calcPairStatistics.m

% This script was written on 2022_01_21 by C. Beal
% Questions or comments? cbeal@bucknell.edu

% Revision history
%     2022_01_21
%     -- wrote the code

% Clear out the workspace
clearvars

% Static test data for testing
pairedXYdata = [5.93317972350230,88.8321167883212,6.51881720430108,88.6921965317919;10.5414746543779,91.7518248175182,10.3718637992832,90.8598265895954;8.00691244239631,85.0364963503650,8.40053763440860,85.0794797687861;11.9239631336406,86.7883211678832,11.6263440860215,86.2355491329480;9.61981566820277,80.6569343065693,10.1030465949821,81.0332369942196;14.4585253456221,82.1167883211679,13.9560931899642,81.6112716763006;11.6935483870968,75.4014598540146,12.2535842293907,75.5419075144509;16.5322580645161,76.8613138686131,16.0170250896057,76.9869942196532;14.2281105990783,70.4379562043796,14.6729390681004,71.2066473988439;18.8364055299539,73.0656934306569,18.4363799283154,72.5072254335260;16.7626728110599,65.4744525547445,17.1818996415771,66.2933526011560;21.6013824884793,68.1021897810219,21.3037634408602,67.1604046242775;19.0668202764977,61.3868613138686,19.6908602150538,61.9580924855491;21.6013824884793,57.2992700729927,21.9310035842294,57.9118497109826;26.9009216589862,59.0510948905109,26.3216845878136,58.4898843930636;29.4354838709677,56.1313868613139,29.0098566308244,55.5997109826590;28.0529953917051,50.0000000000000,28.6514336917563,49.8193641618497;32.4308755760369,53.5036496350365,31.6980286738351,53.1430635838150;36.1175115207373,51.7518248175182,35.8198924731183,50.9754335260115;34.9654377880184,46.7883211678832,34.5654121863799,47.3627167630058;52.9377880184332,50.2919708029197,52.3073476702509,50.8309248554913;53.1682027649770,57.8832116788321,52.9345878136201,57.0447976878613;55.7027649769585,52.6277372262774,55.1747311827957,52.5650289017341;55.7027649769585,60.8029197080292,55.6227598566308,59.9349710982659;58.9285714285714,55.8394160583942,58.2213261648746,56.4667630057803;58.9285714285714,63.4306569343066,58.6693548387097,62.6806358381503;62.1543778801843,57.8832116788321,61.5367383512545,57.7673410404624;65.3801843317972,58.4671532846715,64.6729390681004,58.6343930635838;72.0622119815668,55.2554744525547,71.8413978494624,55.7442196531792;77.3617511520737,60.5109489051095,76.6801075268817,59.9349710982659;80.3571428571429,56.7153284671533,79.9059139784946,56.0332369942196;83.3525345622120,48.2481751824817,82.6836917562724,48.5187861271676;88.4216589861751,52.6277372262774,87.8808243727599,51.8424855491329;87.0391705069124,45.9124087591241,86.6263440860215,46.0621387283237;91.6474654377880,50.0000000000000,91.1066308243728,49.5303468208092;91.4170506912442,44.7445255474453,90.8378136200717,44.6170520231214;95.5645161290323,48.2481751824817,95.0492831541219,47.6517341040462;95.1036866359447,42.9927007299270,94.6012544802867,43.3164739884393];

% Run the statistics on the paired data
[errRMS,errVar,meanShift] = fcn_Points_calcPairStatistics(pairedXYdata);

% Post-process the shift to extract a distance and an angle for easy visual
% checking of the data
shiftDist = norm(meanShift,2);
shiftAngle = atan2(meanShift(2),meanShift(1));

%% Plot and check
figure(17);
clf
hold on
quiver(pairedXYdata(:,1),pairedXYdata(:,2),pairedXYdata(:,3)-pairedXYdata(:,1),pairedXYdata(:,4)-pairedXYdata(:,2),0,'k','linewidth',1)
for i = 1:size(pairedXYdata,1)
    plot([pairedXYdata(i,1) pairedXYdata(i,3)],[pairedXYdata(i,2) pairedXYdata(i,4)],'*')
end